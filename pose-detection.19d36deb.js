import"./camera-identify-p5.2aafa147.js";import"./camera-identify-p5.1c76dd51.js";var e=globalThis,t={},a={},n=e.parcelRequiread69;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in a){var n=a[e];delete a[e];var o={id:e,exports:{}};return t[e]=o,n.call(o.exports,o,o.exports),o.exports}var l=Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}).register=function(e,t){a[e]=t},e.parcelRequiread69=n),n.register;var o=n("g73GA"),l=n("klb57");n("iUyUN"),n("5jdc5");var i=n("7Pz0b");let r=!0,s="",c=null,d=null,g=null,u=document.getElementById("loader");new(i&&i.__esModule?i.default:i)(e=>{async function t(){return new Promise(async(t,a)=>{if(!g)return a(null);await g.loadPixels();let n=e.createImage(192,192);return n.copy(g,0,0,320,320,0,0,192,192),e.image(n,0,0),t(n)})}async function a(e,t){return new Promise(async(a,n)=>{if(!d)return n(null);let o=(await d.detect(t)).filter(e=>"person"===e.class&&e.score>.7);if(o.length<1)return n(null);let l=o[0];e.loadImage(s,t=>{let[n,o,i,r]=l.bbox,s=i>r?i:r,c=n+i/2-s/2,d=o+r/2-s/2,g=e.createImage(192,192);return g.copy(t,c,d,s,s,0,0,192,192),e.image(g,0,0),a(g)})})}async function n(e){return new Promise(async(t,a)=>{if(!c)return a(null);await e.loadPixels();let n=new ImageData(new Uint8ClampedArray(e.pixels),e.width,e.height,{colorSpace:"srgb"}),o=await l.browser.fromPixels(n),i=await c.predict(l.expandDims(o));return t([await i.array(),e.width,e.height])})}function i(t,a,n){for(let o of t[0][0])e.noStroke(),e.fill(0,255,0),o[2]>.5&&e.circle(o[1]*n,o[0]*a,5)}async function f(){try{let e="indexeddb://models/movenet-singlepose-lightning";u.classList.replace("hidden","flex"),console.log("loading movenet model started..."),(await l.io.listModels()).hasOwnProperty(e)?c=await l.loadGraphModel(e):(c=await l.loadGraphModel("https://www.kaggle.com/models/google/movenet/tfJs/singlepose-lightning/4",{fromTFHub:!0}),await c.save(e)),console.log("loading movenet model done...")}catch(e){console.log("something went wrong while loading the pose model...",e)}finally{u.classList.replace("flex","hidden")}}async function p(){console.log("loading cocossd model started");try{u.classList.replace("hidden","flex"),d=await o.load(),console.log("loading cocossd model done")}catch(e){console.log("something went wrong while loading object detection model ...",e)}finally{u.classList.replace("flex","hidden")}}e.setup=async()=>{e.createCanvas(320,320).parent("app"),e.background("black"),e.pixelDensity(1),e.colorMode(e.RGB),e.frameRate(10),e.noLoop(),function(e){var t=e;let o=document.getElementById("btn-camera"),l=document.getElementById("file-upload"),c=document.getElementById("file-info-label");function d(e){if(r=void 0!==e?e:!e){t.background("white"),t.noLoop();return}c.textContent="Browse files",t.loop()}l.addEventListener("change",function(e){let o=e.target;if(!o.files||o.files.length<1)return;s&&URL.revokeObjectURL(s);let l=o.files[0];if(!l.type.startsWith("image/"))throw"Only images can be uploaded!!";d(!0),s=URL.createObjectURL(l),c.textContent=l.name;let r=new Image;r.onload=async function(e){try{let l=e.target;if(o.value="",l.width<192||l.height<192)throw alert("Please provide an image with atleas 192x192px size"),"image size error!";let r=await a(t,this),[s,c,d]=await n(r);i(s,c,d)}catch(e){console.log("error processing...",e)}},r.src=s}),o.addEventListener("click",function(e){e.preventDefault(),g?d(!1):(g=t.createCapture({video:{noiseSuppression:!0,width:320,height:320},audio:!1},{flipped:!0},()=>{d(!1)})).hide()})}(e),await f(),await p()},e.draw=async()=>{if(!r)try{let e=await t(),[a,o,l]=await n(e);i(a,o,l)}catch(e){console.log("error processing...",e)}}});
//# sourceMappingURL=pose-detection.19d36deb.js.map
